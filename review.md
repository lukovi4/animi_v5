–ü–æ–∫–∞ **–Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é (Request changes)** ‚Äî —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –≤—Å—ë –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ç–µ—Å—Ç—ã —Ö–æ—Ä–æ—à–∏–µ, –Ω–æ –µ—Å—Ç—å **2 –±–ª–æ–∫–µ—Ä–∞ –ø–æ –∫–∞—á–µ—Å—Ç–≤—É/–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**, –ø–ª—é—Å 1 –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –ø–æ –¥–µ–º–æ.

---

## ‚ùå –ë–ª–æ–∫–µ—Ä 1 ‚Äî `@unchecked Sendable` —Å–Ω–æ–≤–∞ –ø–æ—è–≤–∏–ª—Å—è

–í `MetalRenderer.swift`:

```swift
public final class MetalRenderer: @unchecked Sendable {
```

–ú—ã —É–∂–µ –æ–¥–∏–Ω —Ä–∞–∑ –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å **–Ω–µ —Ç–∞—â–∏—Ç—å `@unchecked Sendable` –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏** (–≤ PR3 –≤—ã —ç—Ç–æ —É–±–∏—Ä–∞–ª–∏). –ó–¥–µ—Å—å —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –æ–ø–∞—Å–Ω–æ: –≤–Ω—É—Ç—Ä–∏ `MTLDevice / pipeline / buffers`, –∏ –∫–ª–∞—Å—Å –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.

‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:

* **—É–±—Ä–∞—Ç—å `@unchecked Sendable`** —É `MetalRenderer`
* –µ—Å–ª–∏ –≥–¥–µ-—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Ä—É–≥–∞–µ—Ç—Å—è –Ω–∞ concurrency ‚Äî —Ñ–∏–∫—Å–∏—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (`@MainActor` –Ω–∞ VC/—Ä–µ–Ω–¥–µ—Ä-–ø–µ—Ç–ª–µ) –∏–ª–∏ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–µ `@preconcurrency import`, –Ω–æ **–Ω–µ –æ–±—ä—è–≤–ª—è—Ç—å –≤–µ—Å—å renderer ‚Äúsendable‚Äù**.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ API –Ω–µ –º–µ–Ω—è—é—Ç—Å—è.

---

## ‚ùå –ë–ª–æ–∫–µ—Ä 2 ‚Äî SwiftLint: 11 warnings

–Ø –ø—Ä–∏–Ω–∏–º–∞—é PR —Ç–æ–ª—å–∫–æ –ø—Ä–∏ **0 warnings –≤ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö/–Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞—Ö PR7** (—É –Ω–∞—Å —É–∂–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äú0 violations‚Äù –±—ã–ª –º–Ω–æ–≥–æ —Ä–∞–∑).

‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å:

* –ø—Ä–æ–≥–Ω–∞—Ç—å `swiftlint` –∏ —É–±—Ä–∞—Ç—å warnings **–≤ —Ñ–∞–π–ª–∞—Ö PR7 –∏ —Ç–µ—Ö, —á—Ç–æ —Ç—ã —Ç—Ä–æ–≥–∞–ª**:

  * `MetalRenderer*.swift`
  * `TextureProvider.swift`
  * `ScenePackageTextureProvider.swift`
  * `GeometryMapping.swift`
  * `PlayerViewController.swift`
  * `MetalRendererBaselineTests.swift`

–ï—Å–ª–∏ —á–∞—Å—Ç—å warnings –Ω–µ –≤ —ç—Ç–∏—Ö —Ñ–∞–π–ª–∞—Ö ‚Äî –ø—Ä–∏–ª–æ–∂–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π/—Ç–∏–ø–æ–≤ warnings, —á—Ç–æ–±—ã —è –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ –æ–Ω–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å PR7.

---

## ‚ö†Ô∏è –ù–µ –±–ª–æ–∫–µ—Ä ‚Äî –¥–µ–º–æ –º–æ–∂–µ—Ç –Ω–µ –Ω–∞–π—Ç–∏ TestAssets –≤ Bundle

–í `PlayerViewController` —Ç—ã –≥—Ä—É–∑–∏—à—å:

`Bundle.main.url(... subdirectory: "TestAssets/ScenePackages/example_4blocks")`

–≠—Ç–æ **–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å**, –µ—Å–ª–∏ —ç—Ç–∏ –∞—Å—Å–µ—Ç—ã –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ target –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ–Ω–∏ —É –Ω–∞—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –µ—Å—Ç—å –≤ test resources, –Ω–æ –Ω–µ —Ñ–∞–∫—Ç —á—Ç–æ –≤ app bundle).

‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å (–ª—é–±–æ–π –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç):

* –ª–∏–±–æ –¥–æ–±–∞–≤–∏—Ç—å `TestAssets/ScenePackages/example_4blocks` –≤ **Copy Bundle Resources** app target,
* –ª–∏–±–æ –≤ –¥–µ–º–æ –≥—Ä—É–∑–∏—Ç—å –∏–∑ `Bundle.module` (–µ—Å–ª–∏ —ç—Ç–æ —á–∞—Å—Ç—å SwiftPM resources) ‚Äî –Ω–æ —ç—Ç–æ —É–∂–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ —Å–ª–æ–∂–Ω–µ–µ,
* –ª–∏–±–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ —Ç–æ–≥–¥–∞ –≤ UI/–ª–æ–≥–∞—Ö —è–≤–Ω–æ –ø–∏—Å–∞—Ç—å ‚Äúassets must be added to app bundle‚Äù.

---

## –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî üëç

* MVP –±–µ–∑ `quadScale` ‚Äî ‚úÖ (–≤–µ—Ä—à–∏–Ω—ã –≤ px, –∫–∞–∫ –∏ —Ç—Ä–µ–±–æ–≤–∞–ª–∏)
* Y-flip —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `viewportToNDC` ‚Äî ‚úÖ
* transform stack = `current.concatenating(m)` ‚Äî ‚úÖ
* scissor stack + intersect ‚Äî ‚úÖ
* masks/mattes no-op + –±–∞–ª–∞–Ω—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è + —Ç–µ—Å—Ç—ã –Ω–∞ unbalanced ‚Äî ‚úÖ
* offscreen path + –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º ‚Äî ‚úÖ